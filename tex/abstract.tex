% !TEX root = ../thesis.tex

\begin{abstract}
  图方法是机器学习、计算机视觉和数据挖掘中最流行的结构化数据分析方法之一。 图结构使得对数据样本之间的连接建模成为可能。 相似性是数据样本对之间关系的一种测度，可以用于实现图结构上的信息传播。然而，在许多结构化数据的应用中，不存在可供直接获取的合适的关系信息，或者相似性权重中存在大量噪声且对特定任务而言并非是最优的。因此，对图上的信息传播而言，通过观察到的数据信息对样本之间的相似性进行学习是一个十分可行的方案。

  本论文在图像聚类、多模态约束聚类及自然图像抠图三种计算机视觉应用上对数据驱动的相似性学习方法进行了研究。本文的主要研究成果和创新点如下：

  （1）首先对图像聚类任务中的相似性学习进行研究，提出了自适应相似性矩阵（Adaptive Affinity Matrix，AdaAM）方法，用于在谱聚类框架下学习相似性矩阵并推导出相应的距离度量矩阵。AdaAM假设谱聚类中的相似性矩阵为正半定矩阵，且具有描述成对数据间不相似性的能力。所提出的方法主要基于将目标函数的优化视为谱分解问题，而所提供的相似性矩阵可以视为流形上成对关系的最优表示。在多个图像数据集上进行的大量实验证明了AdaAM的有效性和高效性。

  （2）约束传播方法在约束聚类任务中表现出出色的性能，为了解决多模态数据集上的约束传播问题，提出了一种新颖的多模态融合方法，称为多模态融合学习（Multi-modal Fusion Learning，MFL）。所提出的方法可以基于观察到的约束信息和传播过程达到多模态相似性融合学习的结果。其能够处理任何数量的模态，而无需每种模态的任何先验知识。MFL方法将相似性融合学习和约束传播合并为一个统一的问题，并通过有界约束的二次优化来求解。

  （3）提出了特定假设下条件概率分布相容的充分必要条件及一个相容条件概率重构问题的解决方案。在相容条件概率重构方法的帮助下，本文在MFL方法基础上提出了实例级多模态约束传播（Instance Level Multi-Modal Constraint Propagation，ILMCP）方法。ILMCP在数据实例级别对不同模态的相似性进行融合，并学习出了统一的相似性矩阵。在两个公开的多模态数据集上的大量实验表明，该方法具有优越的性能。

  （4）对深度自然图像抠图中的相似性学习进行研究，提出了层次化不透明度传播抠图（Hierarchical Opacity Propagation Matting，HOP Matting）方法。在所提出模型中不透明度信息基于不同的语义级别在每个点的邻域中传播。其层次化结构基于一个全局和多个局部传播模块，高分辨率特征图中的每对特征点都将根据输入图像的外观特征相互连接。本文进一步提出一种针对图像抠图定制的尺度不敏感位置编码，同时将随机插值的数据增广方法引入到图像抠图中。大量的实验和消融研究表明HOP Matting能够在效果上超越目前最新的抠图方法。

  （5）针对无trimap输入的高效图像抠图任务，提出了归纳引导滤波器（Inductive Guided Filter，IGF）方法。归纳引导滤波器利用引导滤波器中隐含的梯度先验，以图像和弱标注分割蒙版作为输入，实现了近似于局部HOP模块的相似性学习效果，同时极大地减少了计算量。本文设计了轻量级网络模型对原始引导滤波器进行参数化，同时提出Gabor损失用于监督图像抠图任务中的复杂纹理信息。实验结果表明，所提出的方法在获得较鲁棒效果的基础上大幅减少了运行时间。

  % 本文首先对聚类任务中的相似性学习进行研究。谱聚类是最流行的聚类方法之一，其能够处理很多具有挑战性的聚类问题。谱聚类中有少量工作集中在学习显式的线性映射上，该类方法也可以被视为距离度量学习的一种。在实际应用中，相似性矩阵的选择对无监督学习的结果表现出巨大的影响。在第二章中，提出了一种称为自适应相似性矩阵（Adaptive Affinity Matrix，AdaAM）的新方法，用于学习自适应相似性矩阵并推导出距离度量。AdaAM假设相似性矩阵为正半定矩阵，且具有描述成对数据间不相似性的能力。所提出的方法主要基于将目标函数的优化视为谱分解问题，而所提供的相似性矩阵可以视为流形上成对关系的最优表示。在多个图像数据集上进行的大量实验证明了AdaAM的有效性和高效性。

  % 约束传播方法在约束聚类任务中表现出出色的性能。尽管近年来已经有一些多模态约束传播方法被提出，但是仍然需要一种可行且鲁棒的在约束传播中实现多模态相似性融合的方法。为了解决多模态数据集上的约束传播问题，本文提出了一种新颖的多模态融合方法，称为多模态融合学习（Multi-modal Fusion Learning，MFL）。所提出的方法可以基于观察到的约束信息和传播过程达到多模态相似性融合学习的结果。其能够处理任何数量的模态，而无需每种模态的任何先验知识。MFL方法将相似性融合学习和约束传播合并为一个统一的问题，并通过有界约束的二次优化来求解。

  % 在MFL方法的基础上，第四章首先提出了在特定假设下条件概率分布相容的充分必要条件，并提出了一个相容条件概率分布重构（Compatible Conditional Distributions Reconstruction，CCDR）问题的解决方案。在CCDR的帮助下，我们提出了一种新的多模态约束传播方法，称为实例级多模态约束传播（Instance Level Multi-Modal Constraint Propagation，ILMCP）。ILMCP在数据实例级别对不同模态的相似性进行融合，并学习出了统一的相似性矩阵。在两个公开的多模态数据集上的大量实验表明，该方法具有优越的性能。

  % 自然图像抠像是计算摄影和计算机视觉中的基本问题。近年来，深度神经网络见证了大量成功的自然图像抠图方法。本文第五章研究了深度图像抠图中的相似性学习。与传统的基于传播的抠图方法不同，部分目前最好的深层图像抠图方法倾向于在神经网络中隐式地执行传播过程。本文的目标是提出一种能在像素之间更直接地进行alpha遮罩值传播的新结构。为此，本文提出了一种层次化不透明度传播抠图（Hierarchical Opacity Propagation Matting， HOP Matting）方法，其中不透明度信息基于不同的语义级别在每个点的邻域中传播。层次化结构基于一个全局和多个局部传播模块。使用HOP结构，高分辨率特征图中的每对特征点都将根据输入图像的外观特征相互连接。我们进一步提出了一种针对图像抠图定制的尺度不敏感位置编码，以处理输入图像尺寸不固定的问题，同时我们将随机插值的数据增广方法引入到图像抠图中。大量的实验和消融研究表明HOP Matting方法能够在效果上超越目前最新的抠图方法。

  % 在第六章中，提出了在无trimap的高效图像抠图任务中利用相似性学习。大多数经典的图像抠图方法通常很耗时，并且需要输入在实际场景中难以获取的理想trimap图。对于移动端应用，需要一种基于弱标注分割蒙版的高效图像抠图方法。本文提出了一种称为归纳引导滤波器（Inductive Guided Filter，IGF）的新颖方法，该方法通过使用弱标注分割蒙版来完成在移动设备上实时的通用图像抠图任务。
  % 归纳引导滤波器利用引导滤波器中隐含的梯度先验，在深度学习方式下极大地减少了计算负担。针对IGF方法，本文设计了一个以图像和弱标注蒙版作为输入的轻量级Hourglass网络来对原始引导滤波器进行参数化，同时提出了Gabor损失用于监督图像抠图任务中的复杂纹理信息。
  % 实验结果表明，所提出的方法在获得较鲁棒的效果基础上大幅减少了运行时间。
\end{abstract}

\begin{enabstract}
  Graph method is one of the most prevalent method for structured data in machine learning, computer vision and data mining. The graph structure makes it feasible to model the connection between data samples. Affinity is a type of measures of the relationship between pairs of data samples, which can be leveraged for information propagation on graph. However, in many applications on structured data, there is no proper relation information can be obtained or affinity weights are noisy and not optimal for a specific task. Learning affinity between samples based on the observed data information is one of the possible way for information propagation on graph.

  This paper investigates the data driven affinity learning in three computer vision applications: image clustering, multi-modal constrained clustering and natural image matting. The main research results and novelties are listed as follows:

  (1) We first investigate the affinity learning in a clustering task and propose a method dubbed Adaptive Affinity Matrix (AdaAM), to learn an affinity matrix and derive a distance metric matrix within the framework of spectral clustering. AdaAM assumes the affinity matrix to be positive semidefinite with ability to quantify the pairwise dissimilarity. Our method is based on posing the optimization of objective function as a spectral decomposition problem. The provided affinity matrix can be regarded as the optimal representation of pairwise relationship on the manifold. Extensive experiments on a number of image data sets show the effectiveness and efficiency of AdaAM.

  (2) Constraint propagation methods demonstrate splendid performance in constrained clustering tasks. To cope with the constraint propagation on multi-modal datasets, we propose a novel multi-modal fusion approach  called Multi-modal Fusion Learning (MFL). The proposed method can reach a multi-modal affinity fusion learning based on the observed constraint information and the propagation process. It is capable of handling any number of modalities without any priori knowledge of each modality. MFL merges the affinity fusion learning and constraint propagation into one unified problem and solve it by a bound-constrained quadratic optimization.

  (3) We identify necessary and sufficient conditions for compatible conditional distributions under a specific assumption and propose a feasible method for Compatible Conditional Distributions Reconstruction (CCDR). With the help of CCDR, we propose a multi-modal constraint propagation method dubbed Instance Level Multi-Modal Constraint Propagation (ILMCP) based on MFL. ILMCP fuses the affinity of different modalities at the data instance level and learns a unified affinity matrix. Extensive experiments on two publicly available multi-modal datasets show the superior performance of the proposed method. 

  (4) We study the affinity learning in deep image matting and propose a Hierarchical Opacity Propagation Matting (HOP Matting) method. In our proposed method, the opacity information is propagated in the neighborhood of each point at different semantic levels. The hierarchical structure is based on one global and multiple local propagation blocks. Every feature point pair in high-resolution feature maps will be connected based on the appearance of input image. We further propose a scale-insensitive positional encoding tailored for image matting and introduce the random interpolation augmentation into image matting. Extensive experiments and ablation study show that HOP matting is capable of outperforming state-of-the-art matting methods.

  (5) For the efficient and trimap-free image matting task, we propose a method called Inductive Guided Filter (IGF). Taking as input an image and a weakly annotated mask, Inductive Guided Filter exploits the implicit gradient prior in Guided Filter, which resembles the affinity learning in a local HOP block and reduces the computational burden tremendously. A lightweight network is devised to parameterize the original Guided Filter method. The use of Gabor loss is also proposed for the supervision of complicated textures in image matting.
  Experimental results demonstrate that our proposed method massively reduces running time with robust accuracy.


  % We first investigate the affinity learning in a clustering task. Spectral clustering is one of the most popular clustering approaches with the capability to handle some challenging clustering problems. Some previous work on spectral clustering focuses on the explicit linear map which can be viewed as the distance metric learning. In practice, the selection of the affinity matrix exhibits a tremendous impact on the unsupervised learning. In the second chapter, we propose a novel method, dubbed Adaptive Affinity Matrix (AdaAM), to learn an adaptive affinity matrix and derive a distance metric. We assume the affinity matrix to be positive semidefinite with ability to quantify the pairwise dissimilarity. Our method is based on posing the optimization of objective function as a spectral decomposition problem. The provided matrix can be regarded as the optimal representation of pairwise relationship on the manifold. Extensive experiments on a number of image data sets show the effectiveness and efficiency of AdaAM.

  % Constraint propagation methods demonstrate splendid performance in constrained clustering tasks. Although some multi-modal constraint propagation methods have been proposed in recent years, a feasible and robust approach to multi-modal affinity fusion in pairwise constraint propagation is still in demand. This paper presents a novel multi-modal fusion approach in order to cope with the constraint propagation on multi-modal datasets, called Multi-modal Fusion Learning (MFL). The proposed method can reach a multi-modal affinity fusion learning based on the observed constraint information and the propagation process. It is capable of handling any number of modalities without any priori knowledge of each modality. MFL merges the affinity fusion learning and constraint propagation into one unified problem and solve it by a bound-constrained quadratic optimization.

  % In the fourth chapter, based on MFL, we first identify a necessary and sufficient condition for compatible conditional distributions under a specific assumption and address the problem of Compatible Conditional Distributions Reconstruction (CCDR). With the help of CCDR, we propose a multi-modal constraint propagation method dubbed Instance Level Multi-Modal Constraint Propagation (ILMCP). ILMCP fuses the affinity of different modalities at the data instance level and learns a unified affinity matrix. Extensive experiments on two publicly available multi-modal datasets show the superior performance of the proposed method. 

  % Natural image matting is a fundamental problem in computational photography and computer vision. Deep neural networks have seen the surge of successful methods in natural image matting in recent years. In the fifth chapter, we study the affinity learning in deep image matting. In contrast to traditional propagation-based matting methods, some top-tier deep image matting approaches tend to perform propagation in the neural network implicitly. We aim to propose a novel structure for more direct alpha matte propagation between pixels. To this end, this paper  presents a hierarchical opacity propagation (HOP) matting method, where the opacity information is propagated in the neighborhood of each point at different semantic levels. The hierarchical structure is based on one global and multiple local propagation blocks. With the HOP structure, every feature point pair in high-resolution feature maps will be connected based on the appearance of input image. We further propose a scale-insensitive positional encoding tailored for image matting to deal with the unfixed size of input image and introduce the random interpolation augmentation into image matting. Extensive experiments and ablation study show that HOP matting is capable of outperforming state-of-the-art matting methods.

  % In the sixth chapter, we propose to utilize the affinity learning in an efficient and trimap-free image matting task. Most of the classical image matting methods are time-consuming and require an ideal trimap which is difficult to attain in practice. An efficient image matting method based on a weakly annotated mask is in demand for mobile applications. We propose a novel method called Inductive Guided Filter (IGF), which tackles the real-time general image matting task with weakly annotated masks on mobile devices. 
  % The Inductive Guided Filter exploits the gradient prior implicit in Guided Filter to reduce the computational burden tremendously in a deep learning manner. A lightweight Hourglass network is devised to parameterize the original Guided Filter method that takes an image and a weakly annotated mask as input. 
  % The use of Gabor loss is also proposed for the supervision of complicated textures in image matting.
  % Experimental results demonstrate that our proposed method massively reduces running time with robust accuracy.

\end{enabstract}
